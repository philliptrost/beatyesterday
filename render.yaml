# Render Blueprint for Beat Yesterday
# https://render.com/docs/blueprint-spec

databases:
  - name: beatyesterday-db
    databaseName: beatyesterday
    user: beatyesterday
    plan: free  # Free tier: 90-day expiration, then $7/month
    region: oregon  # Change to your preferred region
    ipAllowList: []  # Empty = allow all

services:
  - type: web
    name: beat-yesterday
    env: docker  # Use Dockerfile for builds
    region: oregon  # Change to your preferred region
    plan: free  # Free tier: 750 hours/month
    branch: main  # Deploy from main branch
    dockerfilePath: ./Dockerfile
    healthCheckPath: /actuator/health
    envVars:
      # Database connection (auto-linked)
      - key: DATABASE_URL
        fromDatabase:
          name: beatyesterday-db
          property: connectionString

      # Strava credentials (add via Render dashboard)
      - key: STRAVA_CLIENT_ID
        sync: false  # Manually set in dashboard
      - key: STRAVA_CLIENT_SECRET
        sync: false  # Manually set in dashboard
      - key: STRAVA_REFRESH_TOKEN
        sync: false  # Manually set in dashboard

      # Server configuration
      - key: PORT
        value: 8080

      # Spring profile (optional)
      # - key: SPRING_PROFILES_ACTIVE
      #   value: production
